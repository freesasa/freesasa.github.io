<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>FreeSASA: Geometry of Lee &amp; Richards&#39; algorithm</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FreeSASA
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">Open source SASA calculations</div>
  </td>
    <td style="text-align: right; vertical-align: bottom; padding-right: 0.5em">
      View on <a href="http://github.com/mittinatten/freesasa/" id="github"><strong>GitHub</strong></a>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Geometry of Lee &amp; Richards' algorithm </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page explains the geometry of the calculations in L&amp;R and can be used to understand the source code. As far as possible the code uses similar notation to the formulas here.</p>
<p>We will use the following notation: An atom \(i\) has a van der Waals radius \(r_i\), the rolling sphere (or <em>probe</em>) has radius \(r_\text{P}\) and when these are added we get an extended radius \(R_i = r_i + r_\text{P}\). The sphere of radius \(R_i\) centered at the position of atom \(i\) represents the volume not accessible to the center of the probe. The SASA for a molecule is then obtained by calculating the non-buried surface area of the extended spheres.</p>
<p>The L&amp;R algorithm calculates the surface area by slicing the protein, calculating the length of the solvent exposed contours in each slice and then adding up the length multiplied by the slice thickness.</p>
<div class="image">
<img src="../fig/lnr_slice.svg"  alt="Slice in atom"/>
</div>
<p>Divide atom \(i\) into \(n\) slices, orthogonal to an arbitrary axis, of thickness \(\delta = 2R_i/n\). The position of the middle of the slice along that axis is denoted \(z\), and the center of atom \(i\), along the same axis, is at \(z_i\). In each slice, the atom is thus a circle of radius </p><p class="formulaDsp">
\[R_i^\prime = \sqrt{R_i^2-(z-z_i)^2}\,.\]
</p>
<p> These circles are either completely buried inside neighboring atoms, completely exposed, or partially exposed.</p>
<div class="image">
<img src="../fig/lnr_circles.svg"  alt="Overlap of circles"/>
</div>
<p>The exposed arc lengths for each atom can be calculated exactly. For each pair of atoms \(i,j\), the distance between their centers projected on the slice is \(d_{ij}\) (independent of \(z\)). If \(d_{ij} &gt; R_i^\prime + R_j^\prime\), there is no overlap. If \(d_{ij} &lt; R_j^\prime - R_i^\prime\) circle \(i\) is completely inside \(j\) (and the other way around). If \(d_{ij}\) lies between these two cases the angle of circle \(i\) that is buried due to circle \(j\) is</p>
<p class="formulaDsp">
\[ \alpha = 2\arccos \bigl[({R_i^\prime}^2_{\,} + d_{ij}^2 - {R_{j}^\prime}^2_{\,})/(2R_i^\prime d_{ij})\bigr]. \]
</p>
<p>If the middle point of this arc on the circle is at an angle \(\beta\), the arc spans the interval \([\beta-\alpha/2,\beta+\alpha/2]\). By adding up these arcs and taking into account any overlap between them we get the total buried angle \(\gamma\) in this slices. The exposed arc angle for this atom and slice is thus \(2\pi-\gamma\) and the total SASA of that atom</p>
<p class="formulaDsp">
\[ A_i =R_i \delta \!\! \sum_{s\in\text{slices}} \!\! \left[2\pi-\gamma_s\right]\,. \]
</p>
<p>The angle is multiplied by \(R_i\) (not \(R_i^\prime\)) to give the area of a conical frustum circumscribing the sphere at the slice. Finally, the total area \(A\) is the sum of all \(A_i\).</p>
<p>In FreeSASA, the L&amp;R SASA calculation begins by finding overlapping spheres and storing the contacts in an adjacency list. It then iterates through all the slices of each atom and checks for overlap with adjacent atoms in each slice, and adds up the exposed arcs to calculate the atom's contribution to the SASA of the slice. The calculations for each atom are completely independent and can thus be parallelized over an arbitrary number of threads, whereas the calculation of adjacency lists has not been parallelized. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 17 2016 16:18:12 for FreeSASA by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-66397346-1', 'auto');
  ga('send', 'pageview');
  var GitHubLink = document.getElementById('github');
  addListener(GitHubLink, 'click', function() {ga('send', 'event', 'doxygen-github', 'click');});
  function addListener(element, type, callback) {
    if (element.addEventListener) element.addEventListener(type, callback);
    else if (element.attachEvent) element.attachEvent('on' + type, callback);
  }
</script>
</body>
</html>
