<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<title>FreeSASA: FreeSASA API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FreeSASA
   &#160;<span id="projectnumber">2.1.2</span>
   </div>
   <div id="projectbrief">Open source SASA calculations</div>
  </td>
    <td style="text-align: right; vertical-align: bottom; padding-right: 0.5em">
      View on <a href="http://github.com/mittinatten/freesasa/" id="github"><strong>GitHub</strong></a>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">FreeSASA API </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Basic-API"></a>
Basics</h1>
<p >The API is found in the header <a href="freesasa_8h.html">freesasa.h</a>. The other source-files and headers in the repository are for internal use, and are not presented here, but are documented in the source itself. The file <a href="example_8c_source.html">example.c</a> contains a simple program that illustrates how to use the API to read a PDB file from <code>stdin</code> and calculate and print the SASA.</p>
<p >To calculate the SASA of a structure, there are two main options:</p>
<ol type="1">
<li>Initialize a structure from a PDB-file, using either the default classifier or a custom one to determine the radius of each atom, and then run the calculation.</li>
<li>Provide an array of cartesian coordinates and an array containing the radii of the corresponding atoms to <a class="el" href="group__core.html#gab68edbce74d8580c71416d1b3a277bcd" title="Calculates SASA based on a given set of coordinates and radii.">freesasa_calc_coord()</a>.</li>
</ol>
<h2><a class="anchor" id="API-PDB"></a>
Calculate SASA for a PDB file</h2>
<p >The following explains how to use FreeSASA to calculate the SASA of a fictive PDB file (1abc.pdb). At each step one or more error checks should have been done, but these are ignored here for brevity. See the documentation of each function to see what errors can occur. Default parameters are used at every step, the section <a class="el" href="API.html#Customizing">Customizing behavior</a> explains how to configure the calculations.</p>
<h3><a class="anchor" id="API-Read-PDB"></a>
Open PDB file</h3>
<p >The function <a class="el" href="group__structure.html#gacb6a13014452a7c3501fa7661d197f47" title="Init structure with coordinates from pdb-file.">freesasa_structure_from_pdb()</a> reads the atom coordinates from a PDB file and assigns a radius to each atom. The third argument can be used to pass options for how to read the PDB file.</p>
<div class="fragment"><div class="line">FILE *fp = fopen(<span class="stringliteral">&quot;1abc.pdb&quot;</span>);</div>
<div class="line"><span class="keyword">const</span> <a class="code hl_typedef" href="group__classifier.html#gab431aa0f337c6b9968dea85f023c1eb1">freesasa_classifier</a> *classifier = &amp;<a class="code hl_define" href="group__core.html#ga6e74796fee8013e6a5bf66939d0881bf">freesasa_default_classifier</a>;</div>
<div class="line"><a class="code hl_typedef" href="group__structure.html#ga51552cd723c823de3704b0de94142093">freesasa_structure</a> *structure = <a class="code hl_function" href="group__structure.html#gacb6a13014452a7c3501fa7661d197f47">freesasa_structure_from_pdb</a>(fp, classifier, 0);</div>
<div class="ttc" id="agroup__classifier_html_gab431aa0f337c6b9968dea85f023c1eb1"><div class="ttname"><a href="group__classifier.html#gab431aa0f337c6b9968dea85f023c1eb1">freesasa_classifier</a></div><div class="ttdeci">struct freesasa_classifier freesasa_classifier</div><div class="ttdoc">Classifier struct.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00374">freesasa.h:374</a></div></div>
<div class="ttc" id="agroup__core_html_ga6e74796fee8013e6a5bf66939d0881bf"><div class="ttname"><a href="group__core.html#ga6e74796fee8013e6a5bf66939d0881bf">freesasa_default_classifier</a></div><div class="ttdeci">#define freesasa_default_classifier</div><div class="ttdoc">Default freesasa_classifier.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00124">freesasa.h:124</a></div></div>
<div class="ttc" id="agroup__structure_html_ga51552cd723c823de3704b0de94142093"><div class="ttname"><a href="group__structure.html#ga51552cd723c823de3704b0de94142093">freesasa_structure</a></div><div class="ttdeci">struct freesasa_structure freesasa_structure</div><div class="ttdoc">Struct for structure object.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00260">freesasa.h:260</a></div></div>
<div class="ttc" id="agroup__structure_html_gacb6a13014452a7c3501fa7661d197f47"><div class="ttname"><a href="group__structure.html#gacb6a13014452a7c3501fa7661d197f47">freesasa_structure_from_pdb</a></div><div class="ttdeci">freesasa_structure * freesasa_structure_from_pdb(FILE *pdb, const freesasa_classifier *classifier, int options)</div><div class="ttdoc">Init structure with coordinates from pdb-file.</div></div>
</div><!-- fragment --><h3><a class="anchor" id="API-Calc"></a>
Perform calculation and get total SASA</h3>
<p >Next we use <a class="el" href="group__core.html#ga68771c0c8442afe46409abf874e46a98" title="Calculates SASA based on a given structure.">freesasa_calc_structure()</a> to calculate SASA using the structure we just generated, and then print the total area. The argument <code>NULL</code> means use default <a class="el" href="structfreesasa__parameters.html" title="Struct to store parameters for SASA calculation.">freesasa_parameters</a>.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structfreesasa__result.html">freesasa_result</a> *result = <a class="code hl_function" href="group__core.html#ga68771c0c8442afe46409abf874e46a98">freesasa_calc_structure</a>(structure, NULL);</div>
<div class="line">printf(<span class="stringliteral">&quot;Total area: %f A2\n&quot;</span>,result-&gt;<a class="code hl_variable" href="structfreesasa__result.html#afa1bb6cbcea99ae677d9421783d87f93">total</a>);</div>
<div class="ttc" id="agroup__core_html_ga68771c0c8442afe46409abf874e46a98"><div class="ttname"><a href="group__core.html#ga68771c0c8442afe46409abf874e46a98">freesasa_calc_structure</a></div><div class="ttdeci">freesasa_result * freesasa_calc_structure(const freesasa_structure *structure, const freesasa_parameters *parameters)</div><div class="ttdoc">Calculates SASA based on a given structure.</div></div>
<div class="ttc" id="astructfreesasa__result_html"><div class="ttname"><a href="structfreesasa__result.html">freesasa_result</a></div><div class="ttdoc">Struct to store results of SASA calculation.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00267">freesasa.h:267</a></div></div>
<div class="ttc" id="astructfreesasa__result_html_afa1bb6cbcea99ae677d9421783d87f93"><div class="ttname"><a href="structfreesasa__result.html#afa1bb6cbcea99ae677d9421783d87f93">freesasa_result::total</a></div><div class="ttdeci">double total</div><div class="ttdoc">Total SASA in Ångström^2.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00268">freesasa.h:268</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="API-Classes"></a>
Get polar and apolar area</h3>
<p >We are commonly interested in the polar and apolar areas of a molecule, this can be calculated by <a class="el" href="group__core.html#ga1fde9cec02156777eb54b1410e648584" title="Results by classes.">freesasa_result_classes()</a>. To get other classes of atoms we can either define our own classifier, or use <a class="el" href="group__deprecated.html#ga05e643f3fdbca95857f58237cba323e0" title="Get area of a selection.">freesasa_select_area()</a> defined in the next section. The return type <a class="el" href="structfreesasa__nodearea.html" title="Struct to store integrated SASA values for either a full structure or a subset thereof.">freesasa_nodearea</a> is a struct contains the total area and the area of all apolar and polar atoms, and main-chain and side-chain atoms.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structfreesasa__nodearea.html">freesasa_nodearea</a> area = <a class="code hl_function" href="group__core.html#ga1fde9cec02156777eb54b1410e648584">freesasa_result_classes</a>(structure, result);</div>
<div class="line">printf(<span class="stringliteral">&quot;Total      : %f A2\n&quot;</span>, area.<a class="code hl_variable" href="structfreesasa__nodearea.html#a7e027ae87415b7515d1e37c649e38ffd">total</a>);</div>
<div class="line">printf(<span class="stringliteral">&quot;Apolar     : %f A2\n&quot;</span>, area.<a class="code hl_variable" href="structfreesasa__nodearea.html#a5bb334d523e2486eaea4affb02b173b4">apolar</a>);</div>
<div class="line">printf(<span class="stringliteral">&quot;Polar      : %f A2\n&quot;</span>, area.<a class="code hl_variable" href="structfreesasa__nodearea.html#a7bbce5dad63755e82431c815bd56f839">polar</a>);</div>
<div class="line">printf(<span class="stringliteral">&quot;Main-chain : %f A2\n&quot;</span>, area.<a class="code hl_variable" href="structfreesasa__nodearea.html#a797062126856856125671c98290eff51">main_chain</a>);</div>
<div class="line">printf(<span class="stringliteral">&quot;Side-chain : %f A2\n&quot;</span>, area.<a class="code hl_variable" href="structfreesasa__nodearea.html#a0aeee47fbd8bb83586cfab82cc172a6e">side_chain</a>);</div>
<div class="ttc" id="agroup__core_html_ga1fde9cec02156777eb54b1410e648584"><div class="ttname"><a href="group__core.html#ga1fde9cec02156777eb54b1410e648584">freesasa_result_classes</a></div><div class="ttdeci">freesasa_nodearea freesasa_result_classes(const freesasa_structure *structure, const freesasa_result *result)</div><div class="ttdoc">Results by classes.</div></div>
<div class="ttc" id="astructfreesasa__nodearea_html"><div class="ttname"><a href="structfreesasa__nodearea.html">freesasa_nodearea</a></div><div class="ttdoc">Struct to store integrated SASA values for either a full structure or a subset thereof.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00289">freesasa.h:289</a></div></div>
<div class="ttc" id="astructfreesasa__nodearea_html_a0aeee47fbd8bb83586cfab82cc172a6e"><div class="ttname"><a href="structfreesasa__nodearea.html#a0aeee47fbd8bb83586cfab82cc172a6e">freesasa_nodearea::side_chain</a></div><div class="ttdeci">double side_chain</div><div class="ttdoc">Side-chain SASA.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00293">freesasa.h:293</a></div></div>
<div class="ttc" id="astructfreesasa__nodearea_html_a5bb334d523e2486eaea4affb02b173b4"><div class="ttname"><a href="structfreesasa__nodearea.html#a5bb334d523e2486eaea4affb02b173b4">freesasa_nodearea::apolar</a></div><div class="ttdeci">double apolar</div><div class="ttdoc">Apolar SASA.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00295">freesasa.h:295</a></div></div>
<div class="ttc" id="astructfreesasa__nodearea_html_a797062126856856125671c98290eff51"><div class="ttname"><a href="structfreesasa__nodearea.html#a797062126856856125671c98290eff51">freesasa_nodearea::main_chain</a></div><div class="ttdeci">double main_chain</div><div class="ttdoc">Main-chain/Backbone SASA.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00292">freesasa.h:292</a></div></div>
<div class="ttc" id="astructfreesasa__nodearea_html_a7bbce5dad63755e82431c815bd56f839"><div class="ttname"><a href="structfreesasa__nodearea.html#a7bbce5dad63755e82431c815bd56f839">freesasa_nodearea::polar</a></div><div class="ttdeci">double polar</div><div class="ttdoc">Polar SASA.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00294">freesasa.h:294</a></div></div>
<div class="ttc" id="astructfreesasa__nodearea_html_a7e027ae87415b7515d1e37c649e38ffd"><div class="ttname"><a href="structfreesasa__nodearea.html#a7e027ae87415b7515d1e37c649e38ffd">freesasa_nodearea::total</a></div><div class="ttdeci">double total</div><div class="ttdoc">Total SASA.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00291">freesasa.h:291</a></div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="API.html#Classification">Specifying atomic radii and classes</a></dd></dl>
<h3><a class="anchor" id="API-Select"></a>
Get area of custom groups of atoms</h3>
<p >Groups of atoms can be defined using <a class="el" href="group__selection.html#ga17487b15889113bca1a3b147f60547fa" title="Get area of a selection.">freesasa_selection_new()</a>, which takes a selection definition uses a subset of the Pymol select syntax</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__selection.html#ga9e86b116da9eb7aee83176898b89306b">freesasa_selection</a> *selection =</div>
<div class="line">    <a class="code hl_function" href="group__selection.html#ga17487b15889113bca1a3b147f60547fa">freesasa_selection_new</a>(<span class="stringliteral">&quot;aromatic, resn phe+tyr+trp+his+pro&quot;</span>,</div>
<div class="line">                           structure, result);</div>
<div class="line">printf(<span class="stringliteral">&quot;Area of selection &#39;%s&#39;: %f A2\n&quot;</span>,</div>
<div class="line">       <a class="code hl_function" href="group__selection.html#gaa00099b869a280285c698897a4e5ae31">freesasa_selection_name</a>(selection), <a class="code hl_function" href="group__selection.html#gae13b91e1a76b29cafb11b18225719864">freesasa_selection_area</a>(selection);</div>
<div class="ttc" id="agroup__selection_html_ga17487b15889113bca1a3b147f60547fa"><div class="ttname"><a href="group__selection.html#ga17487b15889113bca1a3b147f60547fa">freesasa_selection_new</a></div><div class="ttdeci">freesasa_selection * freesasa_selection_new(const char *command, const freesasa_structure *structure, const freesasa_result *result)</div><div class="ttdoc">Get area of a selection.</div></div>
<div class="ttc" id="agroup__selection_html_ga9e86b116da9eb7aee83176898b89306b"><div class="ttname"><a href="group__selection.html#ga9e86b116da9eb7aee83176898b89306b">freesasa_selection</a></div><div class="ttdeci">struct freesasa_selection freesasa_selection</div><div class="ttdoc">Selection struct.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00361">freesasa.h:361</a></div></div>
<div class="ttc" id="agroup__selection_html_gaa00099b869a280285c698897a4e5ae31"><div class="ttname"><a href="group__selection.html#gaa00099b869a280285c698897a4e5ae31">freesasa_selection_name</a></div><div class="ttdeci">const char * freesasa_selection_name(const freesasa_selection *selection)</div><div class="ttdoc">Name of the selection.</div></div>
<div class="ttc" id="agroup__selection_html_gae13b91e1a76b29cafb11b18225719864"><div class="ttname"><a href="group__selection.html#gae13b91e1a76b29cafb11b18225719864">freesasa_selection_area</a></div><div class="ttdeci">double freesasa_selection_area(const freesasa_selection *selection)</div><div class="ttdoc">Area of the selection.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="Selection.html">Selection syntax</a></dd></dl>
<h3><a class="anchor" id="structure-node"></a>
Navigating the results as a tree</h3>
<p >In addition to the flat array of results in <a class="el" href="structfreesasa__result.html" title="Struct to store results of SASA calculation.">freesasa_result</a>, and the global values returned by <a class="el" href="group__core.html#ga1fde9cec02156777eb54b1410e648584" title="Results by classes.">freesasa_result_classes()</a>, FreeSASA has an interface for navigating the results as a tree. The leaf nodes are individual atoms, and there are parent nodes at the residue, chain, and structure levels. The function <a class="el" href="group__core.html#ga694d04eaa15c74173b8878d33ef21f6f" title="Calculates SASA for a structure and returns as a tree of freesasa_node.">freesasa_calc_tree()</a> does a SASA calculation and returns the root node of such a tree. (If one already has a <a class="el" href="structfreesasa__result.html" title="Struct to store results of SASA calculation.">freesasa_result</a> the function <a class="el" href="group__node.html#ga6dd30a78920ee920362b412fe3a843b2" title="Init tree based on result and structure.">freesasa_tree_init()</a> can be used instead). Each node stores a <a class="el" href="structfreesasa__nodearea.html" title="Struct to store integrated SASA values for either a full structure or a subset thereof.">freesasa_nodearea</a> for the sum of all atoms belonging to the node. The tree can be traversed with <a class="el" href="group__node.html#gacd75910d01e314e90292b3a29e80ca25" title="The children of a node.">freesasa_node_children()</a>, <a class="el" href="group__node.html#ga120a8bde67fb3bf4781bd2f164c91b14" title="The parent of a node.">freesasa_node_parent()</a> and <a class="el" href="group__node.html#gab826f9c8175aea9c7431572f878c1a15" title="Next sibling of a node.">freesasa_node_next()</a>, and the area, type and name using <a class="el" href="group__node.html#ga3837e06dfd91a6b4c57f16ac4426a28f" title="The freesasa_nodearea of all atoms belonging to a node.">freesasa_node_area()</a>, <a class="el" href="group__node.html#ga5204762078ae0caf470fca7b20d50545" title="The type of a node.">freesasa_node_type()</a> and <a class="el" href="group__node.html#ga9bff0c77037701d314679c2c1e8e92f5" title="The name of a node.">freesasa_node_name()</a>. Additionally there are special properties for each level of the tree.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__node.html" title="Represent results as a tree.">Node</a></dd></dl>
<h3><a class="anchor" id="export-tree"></a>
Exporting to RSA, JSON and XML</h3>
<p >The tree structure can also be exported to an RSA, JSON or XML file using <a class="el" href="group__node.html#gaf8df53f196be16eb2761f89a71decae8" title="Outputs result in format specified by options.">freesasa_tree_export()</a>. The RSA format is fixed, but the user can select which levels of the tree to include in JSON and XML. The following illustrates how one would generate a tree and export it to XML, including nodes for the whole structure, chains and residues (but excluding individual atoms).</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__node.html#gac7a00013807eca63024474367c11ea79">freesasa_node</a> *tree = <a class="code hl_function" href="group__core.html#ga694d04eaa15c74173b8878d33ef21f6f">freesasa_calc_tree</a>(structure,</div>
<div class="line">                                         &amp;<a class="code hl_variable" href="group__core.html#gae9d9b203cc6df0d1c81afb6c4c15dff8">freesasa_default_parameters</a>,</div>
<div class="line">                                         &amp;<a class="code hl_define" href="group__core.html#ga6e74796fee8013e6a5bf66939d0881bf">freesasa_default_classifier</a>);</div>
<div class="line">FILE *file = fopen(<span class="stringliteral">&quot;output.xml&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="group__node.html#gaf8df53f196be16eb2761f89a71decae8">freesasa_tree_export</a>(file, tree, <a class="code hl_enumvalue" href="group__node.html#ggad266e870143cf37393eb19fc22184b41a39717994d2f24823ba379d7126f35e6b">FREESASA_XML</a> | <a class="code hl_enumvalue" href="group__node.html#ggad266e870143cf37393eb19fc22184b41ae2977ad1abc0d5c8b5b400332d5763d2">FREESASA_OUTPUT_RESIDUE</a>);</div>
<div class="line">fclose(file);</div>
<div class="line"><a class="code hl_function" href="group__node.html#ga85d2ea683b1231965360c8d8928a2b28">freesasa_node_free</a>(tree);</div>
<div class="ttc" id="agroup__core_html_ga694d04eaa15c74173b8878d33ef21f6f"><div class="ttname"><a href="group__core.html#ga694d04eaa15c74173b8878d33ef21f6f">freesasa_calc_tree</a></div><div class="ttdeci">freesasa_node * freesasa_calc_tree(const freesasa_structure *structure, const freesasa_parameters *parameters, const char *name)</div><div class="ttdoc">Calculates SASA for a structure and returns as a tree of freesasa_node.</div></div>
<div class="ttc" id="agroup__core_html_gae9d9b203cc6df0d1c81afb6c4c15dff8"><div class="ttname"><a href="group__core.html#gae9d9b203cc6df0d1c81afb6c4c15dff8">freesasa_default_parameters</a></div><div class="ttdeci">const freesasa_parameters freesasa_default_parameters</div><div class="ttdoc">The default parameters for FreeSASA.</div></div>
<div class="ttc" id="agroup__node_html_ga85d2ea683b1231965360c8d8928a2b28"><div class="ttname"><a href="group__node.html#ga85d2ea683b1231965360c8d8928a2b28">freesasa_node_free</a></div><div class="ttdeci">int freesasa_node_free(freesasa_node *root)</div><div class="ttdoc">Free tree.</div></div>
<div class="ttc" id="agroup__node_html_gac7a00013807eca63024474367c11ea79"><div class="ttname"><a href="group__node.html#gac7a00013807eca63024474367c11ea79">freesasa_node</a></div><div class="ttdeci">struct freesasa_node freesasa_node</div><div class="ttdoc">Result node.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00352">freesasa.h:352</a></div></div>
<div class="ttc" id="agroup__node_html_gaf8df53f196be16eb2761f89a71decae8"><div class="ttname"><a href="group__node.html#gaf8df53f196be16eb2761f89a71decae8">freesasa_tree_export</a></div><div class="ttdeci">int freesasa_tree_export(FILE *output, freesasa_node *root, int options)</div><div class="ttdoc">Outputs result in format specified by options.</div></div>
<div class="ttc" id="agroup__node_html_ggad266e870143cf37393eb19fc22184b41a39717994d2f24823ba379d7126f35e6b"><div class="ttname"><a href="group__node.html#ggad266e870143cf37393eb19fc22184b41a39717994d2f24823ba379d7126f35e6b">FREESASA_XML</a></div><div class="ttdeci">@ FREESASA_XML</div><div class="ttdoc">XML output.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00208">freesasa.h:208</a></div></div>
<div class="ttc" id="agroup__node_html_ggad266e870143cf37393eb19fc22184b41ae2977ad1abc0d5c8b5b400332d5763d2"><div class="ttname"><a href="group__node.html#ggad266e870143cf37393eb19fc22184b41ae2977ad1abc0d5c8b5b400332d5763d2">FREESASA_OUTPUT_RESIDUE</a></div><div class="ttdeci">@ FREESASA_OUTPUT_RESIDUE</div><div class="ttdoc">Output data for residues, chains and structure.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00202">freesasa.h:202</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="Coordinates"></a>
Coordinates</h2>
<p >If users wish to supply their own coordinates and radii, these are accepted as arrays of doubles passed to the function <a class="el" href="group__core.html#gab68edbce74d8580c71416d1b3a277bcd" title="Calculates SASA based on a given set of coordinates and radii.">freesasa_calc_coord()</a>. The coordinate-array should have size 3*n with coordinates in the order <code>x1,y1,z1,x2,y2,z2,...,xn,yn,zn</code>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> coord[] = {1.0, <span class="comment">/* x */</span></div>
<div class="line">                  2.0, <span class="comment">/* y */</span></div>
<div class="line">                  3.0  <span class="comment">/* z */</span> };</div>
<div class="line"><span class="keywordtype">double</span> radius[] = {2.0};</div>
<div class="line"><span class="keywordtype">int</span> n_atoms = 1;</div>
<div class="line"><a class="code hl_struct" href="structfreesasa__result.html">freesasa_result</a> *result = <a class="code hl_function" href="group__core.html#gab68edbce74d8580c71416d1b3a277bcd">freesasa_calc_coord</a>(coord, radius, n_atoms, NULL);</div>
<div class="ttc" id="agroup__core_html_gab68edbce74d8580c71416d1b3a277bcd"><div class="ttname"><a href="group__core.html#gab68edbce74d8580c71416d1b3a277bcd">freesasa_calc_coord</a></div><div class="ttdeci">freesasa_result * freesasa_calc_coord(const double *xyz, const double *radii, int n, const freesasa_parameters *parameters)</div><div class="ttdoc">Calculates SASA based on a given set of coordinates and radii.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="Error-handling"></a>
Error-handling</h2>
<p >The principle for error handling is that unpredictable errors should not cause a crash, but rather allow the user to exit gracefully or make another attempt. Therefore, errors due to user or system failures, such as faulty parameters, malformatted config-files, I/O errors or out of memory errors, are reported through return values, either <a class="el" href="freesasa_8h.html#a73d4ba1da4f773acd1f0eaa60ed96656aee6a25681197fe7898776680b2469a02" title="Something went seriously wrong (value will always be negative).">FREESASA_FAIL</a> or <a class="el" href="freesasa_8h.html#a73d4ba1da4f773acd1f0eaa60ed96656a38bd3fd2af7bc6bcb9fad27e5e036810" title="Something went wrong, but results might still be meaningful (value will always be negative).">FREESASA_WARN</a>, or by <code>NULL</code> pointers, depending on the context (see the documentation for the individual functions).</p>
<p >Errors that are attributable to programmers using the library, such as passing null pointers where not allowed, are checked by asserts.</p>
<h2><a class="anchor" id="Thread-safety"></a>
Thread-safety</h2>
<p >The only global state the library stores is the verbosity level (set by <a class="el" href="group__core.html#ga68e96bbae0a02282d60468385358f7be" title="Set the global verbosity level.">freesasa_set_verbosity()</a>) and the pointer to the error-log (defaults to <code>stderr</code>, can be changed by <a class="el" href="group__core.html#ga273abc767664492dafe3720f4ca74926" title="Set where to write errors.">freesasa_set_err_out()</a>).</p>
<p >It should be clear from the documentation when the other functions have side effects such as memory allocation and I/O, and thread-safety should generally not be an issue (to the extent that your C library has threadsafe I/O and dynamic memory allocation). The SASA calculation itself can be parallelized by using a <a class="el" href="structfreesasa__parameters.html" title="Struct to store parameters for SASA calculation.">freesasa_parameters</a> struct with <a class="el" href="structfreesasa__parameters.html#ac346f38e5d2102290ff5da97b2f66e5c" title="Number of threads to use, if compiled with thread-support.">freesasa_parameters.n_threads</a> &gt; 1 (default is 2) where appropriate. This only gives a significant effect on performance for large proteins or at high precision, and because not all steps are parallelized it is usually not worth it to go beyond 2 threads.</p>
<h1><a class="anchor" id="Customizing"></a>
Customizing behavior</h1>
<p >The types <a class="el" href="structfreesasa__parameters.html" title="Struct to store parameters for SASA calculation.">freesasa_parameters</a> and <a class="el" href="group__classifier.html#gab431aa0f337c6b9968dea85f023c1eb1" title="Classifier struct.">freesasa_classifier</a> can be used to change the parameters of the calculations. Users who wish to use the defaults can pass <code>NULL</code> wherever pointers to these are requested.</p>
<h2><a class="anchor" id="Parameters"></a>
Parameters</h2>
<p >Calculation parameters can be stored in a <a class="el" href="structfreesasa__parameters.html" title="Struct to store parameters for SASA calculation.">freesasa_parameters</a> object. It can be initialized to default by</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structfreesasa__parameters.html">freesasa_parameters</a> param = <a class="code hl_variable" href="group__core.html#gae9d9b203cc6df0d1c81afb6c4c15dff8">freesasa_default_parameters</a>;</div>
<div class="ttc" id="astructfreesasa__parameters_html"><div class="ttname"><a href="structfreesasa__parameters.html">freesasa_parameters</a></div><div class="ttdoc">Struct to store parameters for SASA calculation.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00232">freesasa.h:232</a></div></div>
</div><!-- fragment --><p >The following code would run a high precision Shrake &amp; Rupley calculation with 10000 test points on the provided structure.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structfreesasa__parameters.html">freesasa_parameters</a> param = <a class="code hl_variable" href="group__core.html#gae9d9b203cc6df0d1c81afb6c4c15dff8">freesasa_default_parameters</a>;</div>
<div class="line">param.<a class="code hl_variable" href="structfreesasa__parameters.html#a05f69e9bfea030dba42b19402a7e6b07">alg</a> = <a class="code hl_enumvalue" href="group__core.html#gga617f4a1c86a13ce900462399583e862cae7e64d18bc061f177318b3015623cb72">FREESASA_SHRAKE_RUPLEY</a>;</div>
<div class="line">param.<a class="code hl_variable" href="structfreesasa__parameters.html#a38040605cf07275820a96d375d2252ef">shrake_rupley_n_points</a> = 10000;</div>
<div class="line"><a class="code hl_struct" href="structfreesasa__result.html">freesasa_result</a> *result = <a class="code hl_function" href="group__core.html#ga68771c0c8442afe46409abf874e46a98">freesasa_calc_structure</a>(structure, param);</div>
<div class="ttc" id="agroup__core_html_gga617f4a1c86a13ce900462399583e862cae7e64d18bc061f177318b3015623cb72"><div class="ttname"><a href="group__core.html#gga617f4a1c86a13ce900462399583e862cae7e64d18bc061f177318b3015623cb72">FREESASA_SHRAKE_RUPLEY</a></div><div class="ttdeci">@ FREESASA_SHRAKE_RUPLEY</div><div class="ttdoc">Shrake &amp; Rupley's algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00092">freesasa.h:91</a></div></div>
<div class="ttc" id="astructfreesasa__parameters_html_a05f69e9bfea030dba42b19402a7e6b07"><div class="ttname"><a href="structfreesasa__parameters.html#a05f69e9bfea030dba42b19402a7e6b07">freesasa_parameters::alg</a></div><div class="ttdeci">freesasa_algorithm alg</div><div class="ttdoc">Algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00233">freesasa.h:233</a></div></div>
<div class="ttc" id="astructfreesasa__parameters_html_a38040605cf07275820a96d375d2252ef"><div class="ttname"><a href="structfreesasa__parameters.html#a38040605cf07275820a96d375d2252ef">freesasa_parameters::shrake_rupley_n_points</a></div><div class="ttdeci">int shrake_rupley_n_points</div><div class="ttdoc">Number of test points in S&amp;R calculation.</div><div class="ttdef"><b>Definition:</b> <a href="freesasa_8h_source.html#l00235">freesasa.h:235</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="Classification"></a>
Specifying atomic radii and classes</h2>
<p >Classifiers are used to determine which atoms are polar or apolar, and to specify atomic radii. In addition the three standard classifiers (see below) have reference values for the maximum areas of the 20 standard amino acids which can be used to calculate relative areas of residues, as in the RSA output.</p>
<p >The default classifier is available through the const variable ::freesasa*default_classifier. This uses the _ProtOr* radii, defined in the paper by Tsai et al. (<a href="http://www.ncbi.nlm.nih.gov/pubmed/10388571">JMB 1999, 290: 253</a>) for the standard amino acids (20 regular plus SEC, PYL, ASX and GLX), for some capping groups (ACE/NH2) and the standard nucleic acids. If the element can't be determined or is unknown, a zero radius is assigned. It classes all carbons as <em>apolar</em> and all other known atoms as <em>polar</em>.</p>
<p >Early versions of FreeSASA used the atomic radii by Ooi et al. (<a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC304812/">PNAS 1987, 84: 3086-3090</a>), this classifier is still available through <a class="el" href="group__classifier.html#ga2e94abebfc55994801a8b396d396516a" title="OONS classifier.">freesasa_oons_classifier</a>.</p>
<p >Users can provide their own classifiers through <a class="el" href="Config-file.html">Classifier configuration files</a>. At the moment these do not allow the user to specify reference values to calculate relative SASA values for RSA output.</p>
<p >The default behavior of <a class="el" href="group__structure.html#gacb6a13014452a7c3501fa7661d197f47" title="Init structure with coordinates from pdb-file.">freesasa_structure_from_pdb()</a>, <a class="el" href="group__structure.html#ga9c8a62298885709a082edbe265347f04" title="Init array of structures from PDB.">freesasa_structure_array()</a>, <a class="el" href="group__structure.html#ga62cd8d35cf36c596f0fa33b586a5f42f" title="Add individual atom to structure using default behavior.">freesasa_structure_add_atom()</a> and <a class="el" href="group__structure.html#ga63b3588a640e46466192724140237571" title="Add individual atom to structure.">freesasa_structure_add_atom_wopt()</a> is to first try the provided classifier and then guess the radius if necessary (emitting warnings if this is done, uses VdW radii defined by <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3658832/">Mantina et al. J Phys Chem 2009, 113:5806</a>).</p>
<p >See the documentation for these functions for what parameters to use to change the default behavior. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 30 2022 11:04:26 for FreeSASA by &#160;<a href="http://www.doxygen.org/index.html">
Doxygen
</a> 1.9.3
</small></address>
</body>
</html>
